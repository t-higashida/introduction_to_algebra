\subsection{素数と素因数分解}
整数$n$が整数$p$で割り切れるとき，すなわち
\[
	n	=	pq
\]
を満たす整数$q$が存在するとき，$p$は$n$の\textbf{約数}（divisor）であるという．
このとき$q$も$n$の約数である．また，$p$を中心に考えるときは，$n$は$p$の
\textbf{倍数}（multiple）という．

\定義{2.1}
自分自身と$1$以外を矢k数として持たない正整数$n	\geqq	2$を\textbf{素数}
（prime number）という．素数でない$2$以上の整数を\textbf{合成数}（composite number）
という．
\□


$2,3,5,7,11$は素数であり，$4=2^2,	6=2	\cdot	3,	8	=	2^3,	9	=	3^2,	12=3\cdot	2^2$は
合成数である．

ところで，素数はどのようにして見つけることができるだろうか．
定義2.1から，$2$は素数であることが分かる．次$3$も素数である．
$4$は$2$で割り切れるので合成数である．$5$は素数である．
$6$は$2$と$3$で割り切れ合成数である．
以下，このように調べていくと，
\[
	2,3,5,7,11,13,17,19,23,29,31,37,41,43,	\cdots
\]
と順に素数を見つけていくことができる．この方法は，効率よく適用したのが，
\textbf{エラトステネスの篩（ふるい）}と呼ばれる方法である．
ます，$2$以上の自然数を順番に並べて書いておく．
\begin{align*}
	&\:2,\:3,\:4,\:5,\:6,\:7,\:8,\:9,10,11,12,13,14,	\\
	&15,16,17,18,19,20,21,22,23,24,25,	\cdots
\end{align*}
最初に現れる$2$は素数である．そこで，$2$より大きい$2$つの倍数をすべて
消してしまう．
\begin{align*}
	&\:2,\:3,\cancel{\:4},\:5,\cancel{\:6},\:7,\cancel{\:8},\:9,\cancel{10},11,\cancel{12},13,\cancel{14},	\\
	&15,\cancel{16},17,\cancel{18},19,\cancel{20},21,\cancel{22},23,\cancel{24},25,	\cdots
\end{align*}
そうして残った数のうち，$2$より大きい最小の数$3$は素数である．
次に$3$より大きい$3$の倍数をすべて消してしまう．
\begin{align*}
	&\:2,\:3,\cancel{\:4},\:5,\cancel{\:6},\:7,\cancel{\:8},\cancel{\:9},\cancel{10},11,\cancel{12},13,\cancel{14},	\\
	&\cancel{15},\cancel{16},17,\cancel{18},19,\cancel{20},\cancel{21},\cancel{22},23,\cancel{24},25,	\cdots
\end{align*}
こうして残った数のうち$3$より大きい最小の数$5$は素数である．つぎに$5$より
大きい$5$の倍数をすべて消してしまう．
\begin{align*}
	&\:2,\:3,\cancel{\:4},\:5,\cancel{\:6},\:7,\cancel{\:8},\cancel{\:9},\cancel{10},11,\cancel{12},13,\cancel{14},	\\
	&\cancel{15},\cancel{16},17,\cancel{18},19,\cancel{20},\cancel{21},\cancel{22},23,\cancel{24},\cancel{25},	\cdots
\end{align*}
こうして残った数のうち$5$より大きい最小の数$7$は素数である．
次に$7$より大きい$7$の倍数をすべて消してしまう．すると$11$が素数であることが分かる．
以下，この操作を続けて，次々に素数を見つけていくことができる．

ところで，エラトステネスの篩法はいつか終わってしまう操作であろうか．
もし，莫大な時間がかかるにせよ，上の操作が有限回で終わってしまえば，
ある大きな自然数$M$以上の自然数はすべて消されてしまっていることになる．
$M$以上の自然数はすべての合成数であり，素数は有限個しかないことになる．

もしそうであれば，数学の世界はずいぶんと貧しいものであろうが，
幸いにして次の大切な事実が古代ギリシャ以来知られている．

\定理{2.2}
素数は無限に存在する．
\□

古代ギリシャ以来知られているユークリッドの証明を述べておこう．

\証明
素数が有限個しか存在しないと仮定して矛盾を示す，いわゆる背理法を使って
証明する．

有限個しかない素数のすべてを
\[
	p_1,	p_2	,	p_3,	\cdots	,	p_N
\]
と記す．自然数
\[
	p=p_1p_2	\cdots	p_N	+1
\]
を考えると，$p$は$p_1,	p_2,	\cdots	,	p_N$で割り切れない．ところが，
一方$p_1,	p_2,	\cdots	,	p_N$はすべて素数であり，任意の$2$以上の自然数は
ある素数で割り切れるので，$p$は$p_1,	p_2,	\cdots	,	p_N$のいずれかで
割り切れなければならない．これは矛盾である．以上によって素数は無限個あることが
分かる．
\■
上の，ユークリッドの証明法に似たクンマー（Kummer）の証明も面白いので
述べておこう．

\証明
素数は有限個しかないと仮定して，上と同様にすべての素数を
\[
	p_1,	p_2,	p_3,	\cdots	,	p_N
\]
と記す．
\[
	M=	p_1	p_2	\cdots	p_N
\]
とおき，$M-1$を考えると，$M-1$は$p_1	,	p_2,	\cdots	,	p_N$のいずれかの素数で
割り切れなければならない．$p_j$が$M-1$を割り切るとしよう．
$p_j$は$M$も割り切るので
\[
	1	=	M	-	(M-1)
\]
も割り切る．これは$p_j	\geqq	2$に矛盾する．
\■

もう1つ別証をあげておこう．これは比較的新しい証明でポリア（Polya）による
（1924年）．そのための準備をしよう．整数$a$と正整数$m$に対して
\begin{equation}
	(a^m	-1)(a^m	+1)	=	a^{2m}	-1
\label{eq2x1}
\end{equation}
が成り立つことは，左辺を展開すると
\[
	a^{2m}	-	a^m	+	a^m	-1
\]
となることより明らかである．そこで，$0$以上の整数$n$に対して
\textbf{フェルマー数}$F_n$を
\begin{equation}
	F_n	=	2^{2^n}	+	1
\label{eq2x2}
\end{equation}
と定義する．ただし$2^0	=1$と約束する（このことは後に詳しく論じる）．
\begin{align*}
	F_0	&=	2+	1	=3,		&F_1	&=	2^2	+1	=	5,	&F_2	&=	2^4+1	=	17,	\\
	F_3	&=	2^8	1	=257,	&F_4	&=	65537,				&F_5	&=	641	\times	6700417
\end{align*}
とフェルマ数は$n$が大きくなると急激に大きくなる．
フェルマは$F_0,	F_1,	F_2,	F_3,	F_4$が素数であることより，
$F_n$はすべて素数であろうと予想したが，1732年オイラーが，
上に示したように$F_5$は合成数であることを示した．
今日でも$n	\geqq	6$のとき祖巣である$F_n$が無限個あるか，あるいは
逆に$F_n$である$F_n$が無限個あるか否かは分かっていない．
$F_n$は大きな数であるので，素数であるか否かを判定するのは，
今日の高速コンピュータを使ってもきわめて難しい．$n	\geqq	6$のとき
$F_n$が素数にある場合は知られておらず，一方合成数であることが分かっている最大
のフェルマ数は，現在のところ$F_{23471}$である．

\例題{2.3}
$	n	\geqq	1$のとき，$F_n$を$F_{n-1}$で割った余りは$2$であること，
さらに詳しく
\begin{equation}
	F_n	=	(2^{n-1}	-	1)	F_{n-1}	+	2
\label{eq2x3}
\end{equation}
が成り立つことを示せ．

\解
\begin{align*}
	F_n	&	=	2^{2^n}+1	=	2^{2^n}	-	1	+	2
				=	(2^{2^{n-1}}	-	1)(2^{2^{n-1}}	+	1)	+	2	\\
				&=	(2^{2^{n-1}}	-	1)	F_{n-1}	+	2
\end{align*}
\■

\例題{2.4}
$n	\geqq	1$のとき
\begin{equation}
	F_n	=	F_0	F_1	F_2	\cdots	F_{n-1}	+	2
\label{eq2x4}
\end{equation}
が成り立つことを示せ．

\解
（\ref{eq2x3}）と（\ref{eq2x2}）より
\begin{align*}
	F_n	&=	(2^{2^{n-1}}	-	1)	F_{n-1}	+	2	\\
			&=	(2^{2^{n-2}}	-1)	(2^{2^{n-2}}	+	1)	F_{n-1}	+2	\\
			&=	(2^{2^{n-2}}	-1)	F_{n-2}	F_{n-1}	+2	\\
			&=	(2^{2^{n-3}}	-1)	F_{n-3}	F_{n-2}	F_{n-1}	+	2	\\
			&=	\cdots	\\
			&=	(2^{2^0}-1)F_0	F_1	\cdots	F_{n-1}	+	2	=	F_0	F_1	\cdots	F_{n-1}	+2
\end{align*}
を得る．
\■

以上の結果より，次の穂第を証明することができる．

\補題{2.5}
素数$p$がフェルマ数$F_n$の約数であれば，$p$は$p$は$F_0,	F_1,	F_2,	\cdots	,	F_{n-1}$
の何れの約数でもない．

\証明
もし$p$がある$F_m	\:	(0	\leqq	m	\leqq	n-1)$の約数であったとすると，
（\ref{eq2x4}）より$p$は
\[
	2	=	F_n	-	F_0	F_1	\cdots	F_{n-1}
\]
の約数でなけらばならず，$p=2$でなければならない．ところが
フェルマ数は奇数であるので$p	\ne	2$である．したがって，
$p$はどの$F_m	\:	(0	\leqq	m	\leq	n-1)$も割り切らない．
\■

補題2.5を使って素数は無限にあることを示してみよう．各自然数$n$に
対して，$F_n$を割り切る素数$p_n$を1つ選ぶ．$p_n$は$F_{n-1},	F_{n-2},	\cdots	,	F_1$
の約数ではないので，$p_{n-1},	p_{n-2},	p_{n-3},	\cdots	,	p_1$とは異なっている．
このようにして，$p_1,	p_2,	p_3,	\cdots	,	p_n	,	p_{n+1}$は相異なる素数であることが
分かり，定理2.2が示された．

素数に関しては，数多くの興味ある事実が知られている．
本シリーズの『数論入門』を参照された．本書でも，関連する話題を後に
いくつか取り上げる．

\問{1}
$2,3,5,7,	\cdots	,	p$を素数を小さい放火並べたものとする．
\begin{list}{}{}
	\item	(1)	$q=	2^2	\cdot	3	\cdot	5	\cdot	7	\cdots	p-1$を$4$で割ったときの
余りは$3$であることを示せ．またこのことを使って，$q$は$p$より大きい$4m	+	3$の
形の素数を約数として持つことを示せ．
	\item	(2)	(1)	を使って，$4n	+	3$の形の素数は無限にあることを示せ．
\end{list}








整数が与えられたとき，その素因数分解を求めるのは簡単ではないが，
自然数$m,n$が与えられたとき，$m$と$N$の最大公約数を割り算をつかって
求めることは原理的に簡単にできる．この方法は，すでに古代ギリシャで知られており，
ユークリッドの『原論』に述べられているので，通常，\textbf{ユークリッドの互除法}
（Euclid's algorithm）と呼ばれる．基本となるのは，次の数の割り算に関する
（当たり前の）結果である．

\命題{2.7}
整数$a$および自然数$b$に対して
\[
	a=qb	+	r	\quad	(0	\leqq	r	<	b)
\]
が成立つ整数$q,r$が一意的に定まる．
\□