\subsection{素因数分解}

自然数$n	\geqq	2$は，素数でなければ，
\[
	n	=	n_1	n_2
\]
と$2$個の$2$以上の自然数の積に分解できる．もし，$n_1$が素数でなければ，
さらに
\[
	n_1	=	n_{11}n_{12}
\]
と2以上の自然数の積に分解できる．$n_2$に関しても同様である．
この操作を続けていくと，自然数$n$は素数の積に分解できることが分かる．
これを$n$の\textbf{素因数分解}という．または因数分解といい，
$p_1,	p_2,	\cdots	,	p_l$を$n$の\textbf{素因数}という．
この分解には，同じ素数が何度も出てくることがあるので，同じ素数の
積はベキ記号を使って
\begin{equation}
	n	=	p_1^{\alpha_1}	p_2^{\alpha_2}	\cdots	p_l^{\alpha_l}
\label{eq2x5}
\end{equation}
と表示することが多い．ここで，$p_1,	p_2,	\cdots	,	p_l$は相異なる素数であり，
$a_1,	a_2,	\cdots	,	a_l$は正整数である．

小さな合成数の素因数分解は
\begin{align*}
	4		&=	2^2,				&	6		&=	2	\cdot	3	,		&	8	&=2^3	,	&	9	&=	3^2	,					&	12	&=	2^2	\cdot	3,\\
	14	&=	2	\cdot	7		&	15	&=	3	\cdot	5,		&16	&=2^4	,	&	18&=	2	\cdot	3^2,	&	20	&=	2^2	\cdot	5,\\
	21	&=	3	\cdot	7,	&	24	&=	2^3	\cdot	3,	&25	&=5^2	,	&	26&=	2	\cdot	13,		&	27	&=	3^3	,	\cdots
\end{align*}
と簡単に求めることができるが，大きな数の素因数分解を見出すのは用意ではない．
たとえばフェルマ数$F_6$の素因数分解
\[
		F_6	=	274177	\times	6728041310721
\]
は1970年にコンピュータを使ってやっと見出された．

ところで（\ref{eq2x5}）の因数分解は素数ベキの掛ける順序を除いて一意的に
決まってしまう．特に
\[
	p_1	<	p_2	<	p_3	<	\cdots	<	p_l
\]
と小さい方から順に素数を取っていけば，$n$を与える毎に（\ref{eq2x5}）の分解は
1通りしかないことが分かる．この事実は，素因数分解の一意性と呼ばれる．

この，一見当たり前の事実をきちんと証明しておこう．

\定理{2.6}
（素因数分解の一意性）
自然数$n	\geqq	2$の素因数分解
\[
	n	=	p_1^{a_1}	p_2^{a_2}	\cdots	p_l^{a_l}
\]
は掛ける順番を除けば一意的に定まる．

\証明
自然数$n$の2通りの素因数分解
\begin{equation}
	p_1^{a_1}	p_2^{a_2}	\cdots	p_l^{a_l}	=	q_1^{b_1}	q_2^{b_2}	\cdots	q_m^{b_m}
\label{eq2x6}
\end{equation}
を考える．$p_1$は$n$の約数であるので（\ref{eq2x6}）の右辺
$q_1^{b_1}	q_2^{b_2}	\cdots	q_m^{b_m}$の約数である．
したがって$p_1$は$q_1,	q_2,	\cdots	,	q_m$の積の組み合わせと一致するが，
$p_1$は素数であるので2つ以上の$q_m$の組み合わせの積とは一致しない，
したがって，$q_1,	q_2,	\cdots	,	q_m$の1つのいずれかと一致する．
必要ならば番号を付け替えることによって
\[
	q_1	=	p_1
\]
と仮定することができる．さらに，$n$は$p_1^{a_1}$で割り切れるので，
\[
	b_1	\geqq	a_1
\]
でなければならない
\footnote{$q_1$の個数$b_1$は，$a_l$個の$p_1$を賄えなければならない．
}．
もし$b_1	>	a_1$であれば
\footnote{
個数$b_1$に余分があれば，
}
（\ref{eq2x6}）の右辺は
$p_1^{a_1+1}$では割り切れることとなるが，(\ref{eq2x6}）の左辺は
$p_1^{a_1+1}$では割り切れない．したがって，
\[
	b_1	=	a_1
\]
であることが分かる．次に$p_2$について同様に考察をすることによって
（再び必要ならば$q_2,	\cdots	,	q_m$の番号を付け替えることによって）
\[
	q_2	=	p_2	,	\quad	b_2	=	a_2
\]
とできることが分かる．以下，同様の考察によって
\[
	q_j	=	p_j	,	\quad	b_j	=	a_j	\quad	(j=1,2,\cdots	,	l)
	\]
と考えてよいことが分かる．もし
\[
	l	<	m
\]
であれば，$m$番目未満の$l+1$番目の素数$q_{l+1}$は$p_1,p_2,	\cdots	,	p_l$と異なり，かつ$n$の約数である．
一方これは（\ref{eq2x6}）の左辺の約数ではないので，$n$の約数ではありえない．
したがって
\[
	l=n
\]
であり，（\ref{eq2x6}）の左辺と右辺の素数のベキの順序の違いを除けば
一致することが分かり，定理は証明された．
\■

ところで，大きな整数$n$が与えられたとき，$n$が素数であるか否かを判定することは
原理的には可能である．素数を小さい方から順に進んで$n$を割り切るかどうかを
調べていけばよいからである．しかしながら，この方法では，
超高速のコンピュータをつかっても長時間かかってしまい，実用上は
使い物にならない．$n$が合成数のとき，その素因数分解を求めるにも
同様の問題がある（この場合は，素数であるか否かを判定する以上に
時間がかかる）．そのために，種々の方法が考えられているが，
今のところ，すべての大きな整数に対して適用できるよい方法は知られていない．
いずれにせよ，整数の持つ性質をさらに詳しく調べる必要がある．

さて，いままでは正整数だけを考察していたが，負整数$n$に対しては，
$n	\leqq	-w2$であれば，正整数$-n$の素因数分解
\[
	-n	=	r_1^{c_1}	r_2^{c_2}	\cdots	r_k^{c_k}
\]
を使って
\begin{equation}
	n	=	-	r_1^{c_1}	r_2^{c_2}	\cdots	r_k^{c_k}
\label{eq2x7}
\end{equation}
と$-1$と素数の積に分解することができる．（\ref{eq2x7}）を
負整数$n$の素因数分解という．

正整数$m,n$が与えられたとき，$m$と$n$の共通の約数を
\textbf{公約数}（common divisor）といい，
公約数のうちで最大のものを\textbf{最大公約数}（greatest common divisor）
という．たとえば$18,45$では
\[
	18	=	2	\cdot	3^2,	\quad	45	=	5	\cdot	3^2
\]
と素因数分解できるので，$1,3,9$が$18$と$45$の公約数であり，したがって
最大公約数は$9$である．また正整数$m,n$の共通の倍数（これを\textbf{公倍数}（
common multiple）という）のうち最小の正整数を\textbf{最小公倍数}（least common multiple）
という．18,45の最小公倍数は$2	\cdot	5	\cdot	3^2	=	90$である．
$18$と$45$の例のように，$m$と$n$の最大公約数，最小公倍数を求めるためには，
$m,n$の素因数分解が分かればよい．
\[
	m=p_1^{a_1}	\cdots	p_k^{a_k}		q_1^{b_1}	q_2^{b_2}	\cdots	q_l^{b_l},
	\quad
	n=	p_1^{c_1}\	\cdots	p_k^{c_k}	q_{l+1}^{d_1}	q_{l+2}^{d_2}	\cdots	q_{l+j}^{d_j}
\]
を，$m,n$を素因数分解する
\footnote{
公約素数を$p_i$，互いに素な素数を$p_j$．
}．
ここで$p_1,	p_2,	\cdots	,	p_k,	q_1	,	\cdots	,	q_{l+j}$
はすべて相異なる素数である．そこで
\begin{align*}
	\alpha_i	=	\min(	a_i,c_i)	\quad	\text{($a_i$と$c_i$のうち小さい方)}	\\
	\beta_i		=	\max(	a_i,c_i)	\quad	\text{($a_i$と$c_i$のうち大きい方)}
\end{align*}
とおくと，最大公約数は
\[
	p_1^{\alpha_1}p_2^{\alpha_2}	\cdots	p_k^{\alpha_k}
\]
であり，最小公倍数は
\[
	p_1^{\beta_1}	p_2^{\beta_1}	\cdots	p_k^{\alpha_k}
	q_1^{b_1}	\cdots	q_l^{b_l}	q_{l+1}^{d_1}	\cdots	q_{l+j}^{d_j}
\]
であることが分かる．またこのことから，$m$と$n$の公約数は
その最大公約数の約数であり，公倍数は最小公倍数の倍数であることが
分かる．また$m$と$n$との最大公約数を$d$とすると，最小公倍数は
\[
	d	\cdot	\frac{m}{d}	\cdot	\frac{n}{d}	=	\frac{mn}{d}
\]
であることも分かる．

最大公約数が$1$のとき，$m$と$n$とは\textbf{互いに素}（relatively prime）という．

整数が与えられたとき，その素因数分解を求めるのは簡単ではないが，
自然数$m,n$が与えられたとき，$m$と$N$の最大公約数を割り算をつかって
求めることは原理的に簡単にできる．この方法は，すでに古代ギリシャで知られており，
ユークリッドの『原論』に述べられているので，通常，\textbf{ユークリッドの互除法}
（Euclid's algorithm）と呼ばれる．基本となるのは，次の数の割り算に関する
（当たり前の）結果である．

\命題{2.7}
整数$a$および自然数$b$に対して
\[
	a=qb	+	r	\quad	(0	\leqq	r	<	b)
\]
が成立つ整数$q,r$が一意的に定まる．
\□

さて，自然数$m,n$が与えられ，$m	>	n$と仮定しよう．
上の命題により
\begin{equation}
	m	=	qn	+	r	\quad	(	0	\leqq	r	<	n)
\label{eq2x8}
\end{equation}
が成り立つように整数$q,r$が定まる．もし$r=0$であれば$m$は$n$の倍数であり，
$m$と$n$の最大公約数は$n$であることが分かる．一方$r	\ne	0$であれば，
さらに割り算を行い．
\begin{equation}
	n	=	q_1	r	+	r_1	\quad	(0	\leqq	r_1	<	r)
\label{eq2x9}
\end{equation}
を得る．もし$r_1	=0$であれば$n$は$r$の倍数であり，
（\ref{eq2x8}）より$m$も$r$の倍数であることが分かる．
このとき，$r$は$m$と$n$との最大公約数である．なぜならば，
最大公約数を$d$とすると（\ref{eq2x8}）より$d$は$r$の約数であり，
一方$r$は$m$と$n$の公約数であり，したがって$r$は$d$の約数であり，
したがって$r=d$となるからである．もし$r_1	\ne	0$であれば
\[
	r	=	q_2	r_1	+	r_2	\quad	(	0	\leqq	r_2	<	r_1)
\]
である．以下$r_2	\ne	0$であれば再び類似の操作を続ける．
こうして割り算の列
\begin{equation}
 \left.
  \begin{earray}
   	&m 	= qn	+	r 			&	\quad	(0	<	r	<	n	)  \\
		&n		=	q_1	r	+	r_1		&	\quad	(0	<	r_1	<	r)	\\
		&r		=	q_2	r_1	+	r_2	&	\quad	(0	<	r_2	<	r_1)	\\
		&r_1	=	q_3	r_2	+	r_3	&	\quad	(0	<	r_3	<	r_2)	\\
	  			&	\cdots		\\
   	&r_{m-3} =	q_{m-1}	r_{m-2}	+	r_{m-1}	&\quad	(0	<	r_{m-1}	<	r_{m-2})	\\
   	&r_{m-2} =	q_m	r_{m-1}	+	r_m	&\quad	(0	<	r_m	<	r_{m-1})	\\
   	&r_{m-1} =	q_{m+1}	r_m	&\quad	(0	<	r_m	<	r_{m-1})
  \end{earray}
 \right\}	
\label{eq2x10}
\end{equation}
ができ，最後に$r_{m-1}$が$r_m$の倍数になってこの操作が終わる．
最後から2番目の式から$r_{m-2}$は$r_m$の倍数である．
すると下から3番目の式より$r_{m-3}$は$r_m$の倍数である．
以下これを繰り返すと$r_m$は$r_{m-1},	r_{m-2},	\cdots	,	r_2,	r_1,	r$
の約数となり，このことから，$n,m$の約数であることが分かる．
したがって$r_m$は$m,n$の最大公約数$d$の約数であることが分かる．
一方，（\ref{eq2x10}）の最初の式より$d$は$r$の約数であり，
したがって2番目の式より$d$は$r_1$の約数であることが分かる．
以下（\ref{eq2x10}）の式を順に見ていくことによって，
$d$は$r_m$の約数であることが分かる．これより$d	=	r_m$であることが
分かる．以下のように，自然数$m$と$n$の最大公約数はユークリッドの
互除法（\ref{eq2x10}）を使って求めることができる．

\問{2}
ユークリッドの互除法を用いて，次の2つの整数の最大公約数を求めよ．
\[
	(1)	\:	124,1782	\qquad	\quad
	(2)	\:	341,	1089	\qquad	\quad
	(3)	\:	1105,	1040
\]

\問{3}
正整数$n_,	n_2,	\cdots	,	n_l$の共通の約数を
\textbf{公約数}，公約数のうち最大のものを\textbf{最大公約数}という．
また$n_1,	n_2,	\cdots	,	n_l$の共通の倍数（\textbf{公倍数}）のうち
最小のものを\textbf{最小公倍数}という．次の整数の組の最大公約数，
最小公倍数を求めよ．
\[
	(1)	\:	3,6,21			\qquad	\quad
	(2)	\:	33,55,77,88	\qquad	\quad
	(3)	\:	131,	1782,	726
\]

\問{4}
正整数$n_1	,	n_2,	n_3$に対して$n_1$と$n_2$の最大公約数を
$d_1$とし，$d_1$と$n_3$の最大公約数を$d$とすると，
$d$は$n_1,	n_2,	n_3$の最大公約数であることを示せ．

ユークリッドの互除法（\ref{eq2x10}）を逆に書いてみよう．すなわち
\[
	r_m	=	r_{m-2}	q_m	r_{m-1}
\]
この式の$r_{m-1}$に下から3番目の式から得られる
\[
	r_{m-1}	=	r_{m-3}	-	q_{m-1}	r_{m-2}
\]
を代入すると
\[
	r_m	=	(1+	q_m	q_{m-1}	)	r_{m-2}	-q_m	r_{m-3}
\]
と書ける．次に$r_{m-2}$に互除法より得られる関係式
\[
	r_{m-2}	=	r_{m-4}	-q_{m-2}	r_{m-3}
\]
を代入して
\[
	r_m	=	a_{m-3}	r_{m-3}	+	a_{m-4}	r_{m-4}
\]
を満足する整数$a_{m-3}	,	a_{m-4}$が存在することが分かる．以下，同じ考え方
を適用することによって
\[
	r_m	=	a_1	r_1	+	a_0	r
\]
を満足する整数$a_1	,	a_0$が存在することが分かる．さらに
\[
	r_1	=	n	-	q_1	r
\]
を代入すると
\[
	r_m	=	a_1	n	+	(	a_0	-	a_1	q_1)	r
\]
を得，最後に
\[
	r=	m	-	qn
\]
を代入すると
\[
	r_m	=	am	+	bn
\]
を満足する整数$a,b$が存在することが分かる．$r_m$は$m$と$n$との最大公約数
であったので，次の大切なん亭利が証明されたことになる．

\定理{2.8}
自然数$m,n$の最大公約数を$d$とすると
\[
	d	=	am	+	bn
\]
を満足する整数$a,b$が存在する．
\□

下の定理2.10で別証を与える．

\定義{2.9}
整数環$\Z$の部分集合$I$が以下の条件を満たすとき，$I$を$\Z$の
\textbf{イデアル}という．
\begin{list}{}{}
	\item	（ⅰ）$m,n	\in	I$であれば$m+n	\in	I$．
	\item	（ⅱ）$m	\in	I$と任意の整数$a$に対して$a	m	\in	I$．
\end{list}
\□

この定義から，$I$が$\Z$のイデアルであるとき，$n	\in	I$であれば，
（ⅱ）より$n	=	(-1)	\cdot	n	\in	I$であり，さらに$m	\in	i$であれば，
（ⅰ）より$m	-n	\in	I$であることが分かる．

さて，整数$m_1	,	m_2,	\cdots	,	m_l$が与えられたとき，
$\Z$の部分集合$(m_1	,	m_2,	\cdots	,	m_l)$を
\[
	(m_1	,	m_2,	\cdots	,	m_l)
	=
	\left\{
		\sum_{j=1}^{l}	a_j	m_j	\:	\bigg|	\:
			a_j	\in	\Z,	j=1,2,	\cdots	,	l
	\right\}
\]
を定めると，これは$\Z$のイデアルであることが分かる．これを，整数
$m_1,	m_2,	\cdots	,	m_l$から生成されるイデアルと呼ぶ．
ただ1つの整数$m$から生成されるイデアル$(m)$を特に\textbf{単項イデアル}という．
次の定理は，定理2.8の一般化である．

\定理{2.10}
整数環$\Z$のイデアル$I$はすべて単項イデアルである．特に整数$m_1,	m_2,	\cdots,	m_l$
から生成されるイデアル$(m_1,	m_2,	\cdots	,	m_l)$に対して，
$m_1	,	m_2	,	\cdots	,	m_l$の最大公約数を$d$とすると
\[
	(m_1,	m_2,	\cdots	,	m_l)	=	(d)
\]
が成り立つ．

\証明
$I=\{	0	\}$のときは定理は正しいので，$I$は$0$以外の元を含んでいると仮定してよい．
$m	\in	I$であれば$-	m		\in	I$であるので，$I$に含まれる最小の正整数を$d$とする．
$I$に属する任意の整数$m$に対して，$m	=	ad	+	b,	\:	0	\leqq	b	<	d$と書くと，
$ad	\in	I$より$b	=	m	-ad	\in	I$であるこが分かる．$d$は$I$に属する
最小の正整数であったので$b=0$でなければならない．これより$I	=	(d)$であることが
示された．

さて，
\[
	(m_1	,	m_2,	\cdots	,	m_l)	=	(d_l)
\]
と書けることが分かった．$(-d_1)	=	(d_1)$であるので$d_1	>	0$と仮定してよい．
\[
	d_1	=	a_1	m_1	+	a_2	m_2	+	\cdots	+	a_l	m_l
\]
と書けるので，$m_1,	m_2,	\cdots	,	m_l$の最大公約数$d$は$d_1$を割り切る．
一方，$m_j	=		b_j	d_j	+	c_j,	0	\leqq	c_j	<	d_1$と書くと，$c_j	=	m_j	-b_j	d_1	\in	I$
である．正整数$d_1$は，上の証明から，$I$に属する最小の正整数である．したがって
$c_j	=	0$でなければならない．すなわち$d_1$は$m_1,	m_2,	\cdots	,	m_l$の公約数である．
したがって$d_1	=	d$である．
\■

\問{5}
次の$\Z$のイデアルを単項イデアルとして表わせ．
\begin{align*}
	\text{（1）}	&(3,-5),	\quad		&	\text{（2）}	&(-6,-8),		\quad	&\text{（3）}	&(180,27),	\\
	\text{（4）}	&(3,6,7),	\quad		&	\text{（5）}	&	(3,-6,8),	\quad	&\text{（6）}	&(-33,55,77)
\end{align*}
