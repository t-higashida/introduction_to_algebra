\subsection{合同式と孫子の剰余定理}

整数の問題では，ある整数の倍数であるか否か，あるいはある整数で割ったときの
余りが等しいかどうかを考えることが多い．こうした問題を解くときに
便利な々を導入しよう．

\定義{2.11}
与えられた整数$m$に対して，2つの整数$n_1,	n_2$は$n_1	-	n_2$が
$m$の倍数であるとき
\begin{equation}
	n_1	\equiv	n_2	\quad	(	\text{mod }	m	)
\label{eq2x11}
\end{equation}
と書き，\textbf{$n_1$は$m$を法として$n_2$と合同}であるという．
\□

たとえば$5-2	=	3	,	5	-	(-1)	=	6$であるので
\[
	5	\equiv	2		\quad	(	\text{mod	}	3	),
	5	\equiv	-1	\quad	(	\text{mod	}	3	),
\]
が成り立つ．また
\[
	n	\equiv	0	\quad	(	\text{mod	}	m	)
\]
であることは$n$が$m$の倍数であることを意味することは定義より
明らかである．

\例題{2.12}
\begin{list}{}{}
	\item	(1)	$n	\geqq	1$のとき
\[
	2^{2^n}	\equiv	1	\quad	(	\text{mod	}	3)
\]
であることを示せ．
	\item	(2)	$n	\geqq	2$のとき
\[
	2^{2^n}	\equiv	1	\quad	(	\text{mod	}	15)
\]
\end{list}
であることを示せ．

\解
(\ref{eq2x1})とフェルマ数の定義(\ref{eq2x2})より
\begin{align*}
	2^{2^n}	-	1	&=	(2^{2^{n-1}}	-	1)(2^{2^{n-1}}	+	1)	\\
							&=	(2^{2^{n-2}}	-1)(2^{2^{n-2}}	+1)(2^{2^{n-1}}	+	1)	\\
							&=	(2^{2^{n-3}}	-1)(2^{2^{n-3}}	+1)(2^{2^{n-2}}	+1)(2^{2^{n-1}}	+	1)	\\
							&=	\cdots	\\
							&=	F_0	F_1	F_2	\cdots	F_{n-1}
\end{align*}
が成り立つ．$F_0	=	3,	F_1	=	5$であるので，$n	\geqq	1$であれば$2^{2^n}	-1$は$3$の倍数で
あり，$n	\geqq	2$であれば$2^{2^n}-1$は$15$の倍数である．
\■

合同式に関して，次の基本的な性質は明らかであろう．

\命題{2.13}
合同式は以下の性質を持つ．
\begin{list}{}{}
	\item	(ⅰ)	$n_1	\equiv	n_2	\:	(	\text{mod	}	m)$であれば$n_2	\equiv	n_1	\:	(	\text{mod } m)$
	\item	(ⅱ)	$n_1	\equiv	n_2	\:	(	\text{mod	}	m)$，$n_2	\equiv	n_3	\:	(	\text{mod	}	m)$であれば
$n_1	\equiv	n_3	\:	(\text{mod } m)$
	\item	(ⅲ)	$n_1	\equiv	n_2	\:	(\text{mod }	m)$であれば$n_1	\equiv	n_2	\:	(\text{mod } -m)$.
\end{list}
\□
上の命題の（ⅲ）より，合同式を考える場合，整数$m	\ne	0$は正整数と仮定してもよいことが分かる．
今後は，特には注意しない限り，整数$m$は正整数と仮定して議論する．

ところで$m=0$として，$0$を法とする合同式を考えることもできるが，$0$以外の整数は$0$の倍数ではないので
\[
	n_1	\equiv	n_2	\:	(	\text{mod } 0)
\]
であることは$n_1	=	n_2$であることと同じである．このことから，$0$を法とする合同式を特に考える
必要はないことが分かる．

さらに，すべての整数は$1$の倍数であるので，任意の整数$n_1,	n_2$に対して
\[
	n_1	\equiv	n_2	\:	(	\text{mod } 1)
\]
も成り立つ．この場合は，合同式を考えることにさして意味がないので，
$1$を法とする合同式も通常は考えない．したがって，以下では，合同式を
考える際は，つねに$2$以上の整数$m$を法として考えることとする．

\例題{2.14}
$m	\geqq	2$を法として考えると，任意の整数$n$は$0	,1,	2,	\cdots	,	m-1$のいずれかと
$m$を法として合同であることを示せ．

\解
\[
	n	=	am	+	b,	\quad	0	\leqq	b	\leqq	m-1
\]
と書くことができるので明らか．
\■

さて$m$が合同数であり
\[
	m	=	m_1	m_2
\]
と$2$以上の整数の積に分解されたとすろと，$n_1	-	n_2$が$m$の倍数であれば，
$m_1$の倍数でもある．したがって，次の補題が示されたことになる．

\補題{2.15}
$m_1$が$m$の約数のとき，
\[
	n_1	\equiv	n_2	\quad	(	\text{mod } m)
\]
が成り立てば
\[
	n_1	\equiv	n_2	\quad	(	\text{mod	}	m_1)
\]
も成り立つ．
\□

この逆にあたることは成り立つであろうか．

\命題{2.16}
$2$以上の整数$m_1,	m_2$が互いに素であるとき，2つの整数$n_1,	n_2$に対して
\[
	n_1	\equiv	n_2	\quad	(	\text{mod } m_1),
	n_1	\equiv	n_2	\quad	(	\text{mod	}	m_2)
\]
が成り立てば
\[
	n_1	\equiv	n_2	\quad	(	\text{mod	}	m_1m_2)
\]
が成り立つ．

\証明
$n_1	\equiv	n_2	\:	(	\text{mod } m_1)$より$n_1	-	n_2$は
$m_1$の倍数である．また$n_1	\equiv	n_2	\:	(	\text{mod } m_2)$より
$n_1	-	n_2$は$m_2$の倍数でもある．さらに，$m_1	,m_2$は共通の素因数
を持たないので$n_1	-	n_2$は$m_1	m_2$の倍数である．したがって
\[
	n_1	\equiv	n_2	\:	(	\text{mod } m_1m_2)
\]
が成り立つ．
\■

しかし，たとえば$m_1	=	2,	m_2	=	6	,	m=12$のとき
\[
	11	\equiv	5	\:	(	\text{mod } 2),	\quad	11	\equiv	5	\:	(	\text{mod } 6)
\]
であるが$11	\equiv	5	(	\text{mod } 12)$であるので，命題2.16で
$m_1$と$m_2$とは互いに素であるという仮定は，はずすことができないことが分かる．

\問{6}
次の合同式を示せ．
\begin{align*}
		\text{(1)}	\:	&2^2	\equiv	1	\:	(	\text{mod } 3)
	&	\text{(2)}	\:	&2^4	\equiv	1	\:	(	\text{mod } 5)
	&	\text{(3)}	\:	&3^4	\equiv	1	\:	(	\text{mod } 5)	\\
		\text{(4)}	\:	&4^4	\equiv	1	\:	(	\text{mod } 5)
	&	\text{(5)}	\:	&1	\cdot	2	\cdot	3	\cdot	4		\equiv	-1	\:	(	\text{mod } 5)
\end{align*}

\問{7}
\begin{list}{}{}
	\item	(1)	$n_1	\equiv	n_2	\:	(\text{mod } m),	l_1	=	l_2	\:	(\text{mod } m)$であれば
\begin{align*}
	n_1	+	l_1	&\equiv	n_2	+	l_2	\:	\quad	(	\text{mod } m)	\\
	n_1	-	l_1	&\equiv	n_2	-	l_2	\:	\quad	(	\text{mod } m)	\\
	n_1	l_1		&\equiv	n_2		l_2	\:	\quad	(	\text{mod } m)	
\end{align*}
が成り立つことを示せ．
	\item	(2)	$a	\equiv	b	\:	(	\text{mod } m)$であれば，任意の正整数$n$に対して
\[
	a^n	\equiv	b^n	(	\text{mod } m)
\]
が成り立つことを示せ．
\end{list}
3世紀後半に著された中国の数学書，いわゆる『孫子算経』に次にような問題と問題の解答が与えられている．

\例題{2.17}
品物があるがその確かな数は分からない．それを3個ずつ数えれば2個余り，5個ずつ数えれば3個余る．
また7個ずつ数えれば2個余る．品物の数はいくつか．

\解
$70,21,15$を考えると，これらの数はそれぞれ$5	\times	7,	3	\times	7,	3	\times	5$の倍数であり，
またそれぞれ$3,5,7$で割ると$1$余る数である．すると
\[
	2	\times	70	+	3	\times	21	+	2	\times	15	=	233
\]
はこの問題の解の1つであることが分かる．$3	\times	5	\times	7$を可能な限り引く（甘いが正整数であるように
引く）と，最小の解23を得る．
\■

この問題を合同式を使って書き直してみよう．品物の数を$x$個とすると，
\begin{equation}
	x	\equiv	2	\quad	(	\text{mod } 3),	\qquad	
	x	\equiv	3	\quad	(	\text{mod } 5),	\qquad
	x	\equiv	2	\quad	(	\text{mod } 7)	
\label{eq2x12}
\end{equation}
が成り立つ．したがって，上の問題は（\ref{eq2x12}）を満足する数$x$を求めることになる．

解の法は何を行っているのであろうか．数$70,21,15$に関して主張していることは
\begin{align*}
	70	&	\equiv	0	\:	(	\text{mod } 5	\times	7),	\quad	70	\equiv	1	\:	(\text{mod } 3)	\\
	21	&	\equiv	0	\:	(	\text{mod } 3	\times	7),	\quad	21	\equiv	1	\:	(\text{mod } 5)	\\
	15	&	\equiv	0	\:	(	\text{mod } 3	\times	5),	\quad	15	\equiv	1	\:	(\text{mod } 7)
\end{align*}
である．この事実と（\ref{eq2x12}）より数
\[
	233 = 2 \times 70 + 3 \times 21 + 2 \times 15
\]
を考えると，$21,15$は$3$の倍数であるので，
\[
	233	\equiv	2	\times	70	\equiv	2	\:	(\text{mod } 3)
\]
を得る．同様の考えで
\begin{align*}
	233	\equiv	3	\times	21	\equiv	3	\:	(	\text{mod } 5)	\\
	233	\equiv	2	\times	15	\equiv	2	\:	(	\text{mod } 7)
\end{align*}
であることが分かる．したがって$x	=	233$は合同式（\ref{eq2x12}）を満足することが
分かる．

ところで$x	=	d_1,	x=d_2$がともに（\ref{eq2x12}）を満足すれば，合同式
\begin{align*}
	d_1	\equiv	2	\:	(	\text{mod } 3),	&	\:		&	d_1	\equiv	3	\:	(	\text{mod } 5),	&	\:	&	d_1	\equiv	2	\:	(\text{mod } 7)	\\	
	d_2	\equiv	2	\:	(	\text{mod } 3),	&	\:		&	d_2	\equiv	3	\:	(	\text{mod } 5),	&	\:	&	d_2	\equiv	2	\:	(\text{mod } 7)
\end{align*}
より
\[
	d_2	-	d_1	\equiv	0	\:	(	\text{mod } 3),	\quad
	d_2	-	d_1	\equiv	0	\:	(	\text{mod } 5),	\quad
	d_2	-	d_1	\equiv	0	\:	(	\text{mod } 7)
\]
が成り立つ．したがって，$d_2	>	d_1$とすれば$d_2	-	d_1$は$3,5,7$の最小公倍数
$	3	\times	5	\times	7	=	105$の倍数であることが分かる．

逆に$x = d_1$が(\ref{eq2x12})を満足すれば$d_2=d_1+105m$も(\ref{eq2x12})を満足すること
が分かる.

以上の論法で大切だったのは,実は$3,5,7$のどの2つも互いに素であると
いう事実であり,$3,5,7$が素数であることは重要ではない.
(\ref{eq2x12})のような連立の合同式を満足する整数を求める問題は『孫子算経』
のあとを受けて,8世紀に泰九詔が著書『数書九章』の中で詳しく論じた.
このことにちなんで,次の定理はヨーロッパでは\textbf{中国の剰余定理}(Chinese
maindertheorem)と言われることが多いが,本書では現代中国で使われてる呼称,
\textbf{孫子の剰余定理}と呼ぶことにする.

\定理{2.18}(孫子の剰余定理)

正整数$m_1,m_2,m_3,	\cdots	,m_k$はどの2つも互いに素であると仮定する.
このとき,任意の整数$\alpha_1,\alpha_2,\alpha_3,	\cdots,	\alpha_k$に対して,
\begin{equation}
			a	\equiv	a_1	\quad	(\text{mod}	 m_1),
			a	\equiv	a_2	\quad	(\text{mod}	m_2	)
	\label{eq2x13}
\end{equation}
を満足する整数$a$が存在する.整数$a$は$m_1,	m_2,	\cdots,	m_k$を法として一意的に定
まる.したがって,特に上の合同式を満足し,
\[
	0	\leqq		a	<	m_1	\cdot	m_2	\cdot	m_k
\]
を満足する正整数$a$はただ1つ存在する.
\□

この定理の証明には,次の補題が必要になる.

\補題{2.19}
互いに素な正整数$m,n$と任意の整数$\beta$に対して,
\[
	\alpha	\equiv	\beta	(\text{mod}	\:	m)
	\alpha	\equiv	0			(\text{mod}	\:	n)
\]
を満足する整数$\alpha$が存在する.

\証明

定理2.8より
\[
	1=am	+	bn
\]
を満足する整数$a,b$が存在する.この式の両辺を$\beta$倍すると
\[
	\beta=a	\beta	m	+	b	\beta	n
\]
となる.そこで$\alpha=b	\beta	n$	とおくと,この等式より
\[
	\alpha	\equiv	\beta	\quad	(	\text{mod}	\:	m)
\]
が成立する.$\alpha$は$n$の倍数であるので

\[
	a	\equiv	0	\quad	(\text{mod}	\:	n)
\]
が成り立つ.
\■

[定理2.18の証明]
\[
	m	=	m_1		\cdot	m_2	\cdot	m_k
\]
とおくと，定理の仮定より,$m_j$と$m/m_j	\:	(j=1,2,	\cdots	,	k)$は互いに素である.
したがって,補題2.19より
